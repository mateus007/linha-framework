{"version":3,"file":"lazy.js.map","sources":["../../../src/framework/lazy/lazy.ts"],"sourcesContent":["/**\n * Cross-browser lazy loading library compatible with \"loading\" attribute.\n *\n * Simple image:\n * <img loading=\"lazy\" data-src=\"\" src=\"\" ... />\n *\n * With picture:\n * <picture>\n *    <source data-srcset=\"\" .../>\n *    <img loading=\"lazy\" data-src=\"\" src=\"\" ... />\n * </picture>\n */\ndocument.addEventListener('DOMContentLoaded', function(){\n\n    var active = false;\n    var elements = Array.from( document.querySelectorAll('[loading]') );\n\n    /**\n     * Update element attributes\n     * @param {Element} element\n     * @return {void}\n     */\n    function updateElement(element: HTMLImageElement | HTMLSourceElement): void{\n\n        if( element.dataset.src ){\n            element.src = element.dataset.src;\n        }\n        if( element.dataset.srcset ){\n            element.srcset = element.dataset.srcset;\n        }\n        if( element.dataset.sizes ){\n            element.sizes = element.dataset.sizes;\n        }\n\n        element.classList.remove('lazy');\n\n    }\n\n    /**\n     * Load element\n     * @param {Element} element\n     * @return {void}\n     */\n    function loadElement(element: HTMLImageElement): void{\n\n        updateElement(element);\n\n        // Process sibling <source/> element\n        var child = element.parentElement.querySelectorAll('source');\n            child = [].slice.call(child);\n\n        if( !child.length ){\n            return;\n        }\n\n        child.forEach(function(childElement){\n            updateElement(childElement);\n        });\n\n    }\n\n    /**\n     * Return if element is in viewport\n     * @param {Element} element\n     * @return {Boolean}\n     */\n    function isInViewport(element: Element): boolean{\n        return ( element.getBoundingClientRect().top <= window.innerHeight\n                && element.getBoundingClientRect().bottom >= 0 )\n                && getComputedStyle(element).display !== 'none';\n    }\n\n    /**\n     * Process and load elements\n     * @return {void}\n     */\n    function processElements(): void{\n\n        if( elements.length === 0 ){\n            return;\n        }\n\n        elements.forEach(function(element: HTMLImageElement){\n            if( isInViewport(element) ){\n\n                loadElement(element);\n                elements = elements.filter(function(theElement: HTMLImageElement) {\n                    return element !== theElement;\n                });\n\n            }\n        });\n\n    }\n\n    /**\n     * Lazy load elements\n     * @return {void}\n     */\n    function lazyLoad(): void{\n\n        if( active ){\n            return;\n        }\n\n        active = true;\n        window.setTimeout(function(){\n\n            processElements();\n\n            if( elements.length === 0 ){\n                document.removeEventListener('scroll', lazyLoad);\n                window.removeEventListener('resize', lazyLoad);\n                window.removeEventListener('orientationchange', lazyLoad);\n            }\n\n            active = false;\n\n        }, 200);\n\n    }\n\n    if( 'loading' in HTMLImageElement.prototype ){\n        elements.forEach(loadElement);\n    }else{\n        document.addEventListener('scroll', lazyLoad);\n        window.addEventListener('resize', lazyLoad);\n        window.addEventListener('orientationchange', lazyLoad);\n        lazyLoad();\n    }\n\n});"],"names":["document","addEventListener","active","elements","Array","from","querySelectorAll","updateElement","element","dataset","src","srcset","sizes","classList","remove","loadElement","child","parentElement","slice","call","length","forEach","childElement","processElements","getBoundingClientRect","top","window","innerHeight","bottom","getComputedStyle","display","isInViewport","filter","theElement","lazyLoad","setTimeout","removeEventListener","HTMLImageElement","prototype"],"mappings":"AAYAA,SAASC,iBAAiB,mBAAoB,WAE1C,IAAIC,QAAS,EACTC,SAAWC,MAAMC,KAAML,SAASM,iBAAiB,cAOrD,SAASC,cAAcC,SAEfA,QAAQC,QAAQC,MAChBF,QAAQE,IAAMF,QAAQC,QAAQC,KAE9BF,QAAQC,QAAQE,SAChBH,QAAQG,OAASH,QAAQC,QAAQE,QAEjCH,QAAQC,QAAQG,QAChBJ,QAAQI,MAAQJ,QAAQC,QAAQG,OAGpCJ,QAAQK,UAAUC,OAAO,QAS7B,SAASC,YAAYP,OAEjBD,cAAcC,OAGVQ,MAAQR,MAAQS,cAAcX,iBAAiB,WAC/CU,MAAQ,GAAGE,MAAMC,KAAKH,QAEfI,QAIXJ,MAAMK,QAAQ,SAASC,cACnBf,cAAce,gBAoBtB,SAASC,kBAEmB,IAApBpB,SAASiB,QAIbjB,SAASkB,QAAQ,SAASb,UAhB9B,SAAsBA,SAClB,OAASA,QAAQgB,wBAAwBC,KAAOC,OAAOC,aACF,GAA1CnB,QAAQgB,wBAAwBI,QACM,SAAtCC,iBAAiBrB,SAASsB,QAc7BC,CAAavB,WAEbO,YAAYP,SACZL,SAAWA,SAAS6B,OAAO,SAASC,YAChC,OAAOzB,UAAYyB,gBAYnC,SAASC,WAEDhC,SAIJA,QAAS,EACTwB,OAAOS,WAAW,WAEdZ,kBAEwB,IAApBpB,SAASiB,SACTpB,SAASoC,oBAAoB,SAAUF,UACvCR,OAAOU,oBAAoB,SAAUF,UACrCR,OAAOU,oBAAoB,oBAAqBF,WAGpDhC,QAAS,GAEV,MAIH,YAAamC,iBAAiBC,UAC9BnC,SAASkB,QAAQN,cAEjBf,SAASC,iBAAiB,SAAUiC,UACpCR,OAAOzB,iBAAiB,SAAUiC,UAClCR,OAAOzB,iBAAiB,oBAAqBiC,UAC7CA"}